{% include 'head.html' %} {% include 'nav.html' %} {% include 'jumbotron.html' %}

<div class="container pt-0 mb-3">
    <div class="row">
        <div class="col">

            {% if vars.saved %}
            <div class="alert alert-success" role="alert">
                <strong>Well done!</strong> The Configuration was saved successfully.
            </div>
            {% endif %}

            {% if vars.error %}
            <div class="alert alert-danger" role="alert">
                <strong>Oops!</strong> {{ vars.error }}
            </div>
            {% endif %}

            <div class="card">
                <div class="card-header">
                    <ul class="nav nav-tabs card-header-tabs">
                        <li class="nav-item">
                            <a class="nav-link {% if vars.active_tab == 'iptables' %}active{% endif %}"
                                data-toggle="tab" href="#iptables" role="tab">iptables</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if vars.active_tab == 'netinterfaces' %}active{% endif %}" data-toggle="tab"
                                href="#netinterfaces" role="tab">Network Interfaces</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if vars.active_tab == 'ipv6' %}active{% endif %}" data-toggle="tab"
                                href="#ipv6" role="tab">IPv6</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if vars.active_tab == 'acceptance' %}active{% endif %}"
                                data-toggle="tab" href="#acceptance" role="tab">Acceptance</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if vars.active_tab == 'logging' %}active{% endif %}" data-toggle="tab"
                                href="#logging" role="tab">Logging</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if vars.active_tab == 'binaries' %}active{% endif %}"
                                data-toggle="tab" href="#binaries" role="tab">Binaries</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if vars.active_tab == 'webinterface' %}active{% endif %}"
                                data-toggle="tab" href="#webinterface" role="tab">Webinterface</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if vars.active_tab == 'user' %}active{% endif %}" data-toggle="tab"
                                href="#user" role="tab">User</a>
                        </li>
                    </ul>
                </div>

                <div class="card-body">
                    <div class="tab-content">

                        <div class="tab-pane {% if vars.active_tab == 'iptables' %}active{% endif %}" id="iptables"
                            role="tabpanel">
                            <form action="/options-save" method="post">

                                <input type="hidden" name="section" value="IPTABLES">
                                <input type="hidden" name="cfgtype" value="easywall">
                                <input type="hidden" name="active_tab" value="iptables">

                                <div class="row">
                                    <div class="col-sm-4 mb-5">
                                        <div class="card border-secondary">
                                            <div class="card-header">
                                                Blocked Connections
                                            </div>
                                            <div class="card-body">
                                                <div class="form-group">
                                                    <input type="hidden" value="off"
                                                        name="checkbox_log_blocked_connections">
                                                    <input type="checkbox" id="log_blocked_connections"
                                                        name="log_blocked_connections"
                                                        {% if vars.config.get_value("IPTABLES", "log_blocked_connections") == true %}
                                                        checked {% endif %}
                                                        aria-describedby="log_blocked_connections_help">
                                                    <label class="form-check-label" for="log_blocked_connections">
                                                        Log all blocked connections to syslog
                                                    </label>
                                                    <small id="log_blocked_connections_help"
                                                        class="form-text text-muted">
                                                        If the configuration is enabled, all blocked incoming
                                                        connections are
                                                        logged in
                                                        the syslog. Please make sure that the syslog is rotated
                                                        regularly to
                                                        avoid large
                                                        logfiles.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <label for="log_blocked_connections_log_limit">
                                                        Limit of entries in the log to blocked connections per minute
                                                    </label>
                                                    <input type="text" class="form-control"
                                                        id="log_blocked_connections_log_limit"
                                                        name="log_blocked_connections_log_limit"
                                                        aria-describedby="log_blocked_connections_log_limit_help"
                                                        placeholder="Example: 60"
                                                        {% if vars.config.get_value("IPTABLES", "log_blocked_connections_log_limit") != "" %}
                                                        value={{vars.config.get_value("IPTABLES", "log_blocked_connections_log_limit")}}
                                                        {% endif %}>
                                                    <small id="log_blocked_connections_log_limit_help"
                                                        class="form-text text-muted">
                                                        Please enter the number of entries to be stored per minute in
                                                        the log file. The configuration is needed to avoid log file
                                                        flooding.
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-4 mb-5">
                                        <div class="card border-secondary">
                                            <div class="card-header">
                                                Blacklisted Connections
                                            </div>
                                            <div class="card-body">
                                                <div class="form-group">
                                                    <input type="hidden" value="off"
                                                        name="checkbox_log_blacklist_connections">
                                                    <input type="checkbox" id="log_blacklist_connections"
                                                        name="log_blacklist_connections"
                                                        {% if vars.config.get_value("IPTABLES", "log_blacklist_connections") == true %}
                                                        checked {% endif %}
                                                        aria-describedby="log_blacklist_connections_help">
                                                    <label class="form-check-label" for="log_blacklist_connections">
                                                        Log blocked connections from blacklist
                                                    </label>
                                                    <small id="log_blacklist_connections_help"
                                                        class="form-text text-muted">
                                                        To check if IP addresses on the blacklist are still trying to
                                                        connect to
                                                        your
                                                        system, you can enable this checkbox. All incoming connections
                                                        from
                                                        blocked IP
                                                        addresses are then logged in the syslog.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <label for="log_blacklist_connections_log_limit">
                                                        Limit of entries in the log to blacklisted connections per
                                                        minute
                                                    </label>
                                                    <input type="text" class="form-control"
                                                        id="log_blacklist_connections_log_limit"
                                                        name="log_blacklist_connections_log_limit"
                                                        aria-describedby="log_blacklist_connections_log_limit_help"
                                                        placeholder="Example: 60"
                                                        {% if vars.config.get_value("IPTABLES", "log_blacklist_connections_log_limit") != "" %}
                                                        value={{vars.config.get_value("IPTABLES", "log_blacklist_connections_log_limit")}}
                                                        {% endif %}>
                                                    <small id="log_blacklist_connections_log_limit_help"
                                                        class="form-text text-muted">
                                                        Please enter the number of entries to be stored per minute in
                                                        the log file. The configuration is needed to avoid log file
                                                        flooding.
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-4 mb-5">
                                        <div class="card border-secondary">
                                            <div class="card-header">
                                                Broadcast, Multicast, Anycast
                                            </div>
                                            <div class="card-body">
                                                <div class="form-group">
                                                    <input type="hidden" value="off"
                                                        name="checkbox_drop_broadcast_packets">
                                                    <input type="checkbox" id="drop_broadcast_packets"
                                                        name="drop_broadcast_packets"
                                                        {% if vars.config.get_value("IPTABLES", "drop_broadcast_packets") == true %}
                                                        checked {% endif %}
                                                        aria-describedby="drop_broadcast_packets_help">
                                                    <label class="form-check-label" for="drop_broadcast_packets">
                                                        Reject broadcast packets
                                                    </label>
                                                    <small id="drop_broadcast_packets_help"
                                                        class="form-text text-muted">
                                                        If this field is activated, all incoming packets of type
                                                        Broadcast are rejected. This can cause problems with DHCP
                                                        servers or clients.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <input type="hidden" value="off"
                                                        name="checkbox_drop_multicast_packets">
                                                    <input type="checkbox" id="drop_multicast_packets"
                                                        name="drop_multicast_packets"
                                                        {% if vars.config.get_value("IPTABLES", "drop_multicast_packets") == true %}
                                                        checked {% endif %}
                                                        aria-describedby="drop_multicast_packets_help">
                                                    <label class="form-check-label" for="drop_multicast_packets">
                                                        Reject multicast packets
                                                    </label>
                                                    <small id="drop_multicast_packets_help"
                                                        class="form-text text-muted">
                                                        If this field is activated, all incoming packets of type
                                                        Multicast are
                                                        rejected.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <input type="hidden" value="off"
                                                        name="checkbox_drop_anycast_packets">
                                                    <input type="checkbox" id="drop_anycast_packets"
                                                        name="drop_anycast_packets"
                                                        {% if vars.config.get_value("IPTABLES", "drop_anycast_packets") == true %}
                                                        checked {% endif %}
                                                        aria-describedby="drop_anycast_packets_help">
                                                    <label class="form-check-label" for="drop_anycast_packets">
                                                        Reject anycast packets
                                                    </label>
                                                    <small id="drop_anycast_packets_help" class="form-text text-muted">
                                                        If this field is activated, all incoming packets of type
                                                        Anycast are
                                                        rejected.
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-sm-6 mb-5">
                                        <div class="card border-secondary">
                                            <div class="card-header">
                                                SSH brute force Prevention
                                            </div>
                                            <div class="card-body">
                                                <div class="form-group">
                                                    <input type="hidden" value="off"
                                                        name="checkbox_ssh_brute_force_prevention">
                                                    <input type="checkbox" id="ssh_brute_force_prevention"
                                                        name="ssh_brute_force_prevention"
                                                        {% if vars.config.get_value("IPTABLES", "ssh_brute_force_prevention") == true %}
                                                        checked {% endif %}
                                                        aria-describedby="ssh_brute_force_prevention_help">
                                                    <label class="form-check-label" for="ssh_brute_force_prevention">
                                                        SSH brute force Prevention
                                                    </label>
                                                    <small id="ssh_brute_force_prevention_help"
                                                        class="form-text text-muted">
                                                        If you check this box, the SSH port is specially protected. To
                                                        do this, you must mark the SSH port with the "SSH" option under
                                                        Ports.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <input type="hidden" value="off"
                                                        name="checkbox_ssh_brute_force_prevention_log">
                                                    <input type="checkbox" id="ssh_brute_force_prevention_log"
                                                        name="ssh_brute_force_prevention_log"
                                                        {% if vars.config.get_value("IPTABLES", "ssh_brute_force_prevention_log") == true %}
                                                        checked {% endif %}
                                                        aria-describedby="ssh_brute_force_prevention_log_help">
                                                    <label class="form-check-label"
                                                        for="ssh_brute_force_prevention_log">
                                                        Log all blocked connections from SSH brute force prevention
                                                    </label>
                                                    <small id="ssh_brute_force_prevention_log_help"
                                                        class="form-text text-muted">
                                                        If you check this box, SSH brute force prevention will record
                                                        the blocked connections in syslog. Please make sure that the
                                                        syslog is rotated regularly to avoid large logfiles.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <label for="ssh_brute_force_prevention_connection_limit">
                                                        Number of connections to the SSH port until the sender is
                                                        blocked
                                                    </label>
                                                    <input type="text" class="form-control"
                                                        id="ssh_brute_force_prevention_connection_limit"
                                                        name="ssh_brute_force_prevention_connection_limit"
                                                        aria-describedby="ssh_brute_force_prevention_connection_limit_help"
                                                        placeholder="Example: 5"
                                                        {% if vars.config.get_value("IPTABLES", "ssh_brute_force_prevention_connection_limit") != "" %}
                                                        value={{vars.config.get_value("IPTABLES", "ssh_brute_force_prevention_connection_limit")}}
                                                        {% endif %}>
                                                    <small id="ssh_brute_force_prevention_connection_limit_help"
                                                        class="form-text text-muted">
                                                        Please enter the number of connections per minute on the SSH
                                                        port until
                                                        the
                                                        sender address is blocked.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <label for="ssh_brute_force_prevention_log_limit">
                                                        Limit of entries in the log to blocked connections per
                                                        minute
                                                    </label>
                                                    <input type="text" class="form-control"
                                                        id="ssh_brute_force_prevention_log_limit"
                                                        name="ssh_brute_force_prevention_log_limit"
                                                        aria-describedby="ssh_brute_force_prevention_log_limit_help"
                                                        placeholder="Example: 5"
                                                        {% if vars.config.get_value("IPTABLES", "ssh_brute_force_prevention_log_limit") != "" %}
                                                        value={{vars.config.get_value("IPTABLES", "ssh_brute_force_prevention_log_limit")}}
                                                        {% endif %}>
                                                    <small id="ssh_brute_force_prevention_log_limit_help"
                                                        class="form-text text-muted">
                                                        Please enter the number of entries created by the ssh brute
                                                        force prevention to be stored per minute in the log file. The
                                                        configuration is needed to avoid log file flooding.
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6 mb-5">
                                        <div class="card border-secondary">
                                            <div class="card-header">
                                                ICMP flood Prevention
                                            </div>
                                            <div class="card-body">
                                                <div class="form-group">
                                                    <input type="hidden" value="off"
                                                        name="checkbox_icmp_flood_prevention">
                                                    <input type="checkbox" id="icmp_flood_prevention"
                                                        name="icmp_flood_prevention"
                                                        {% if vars.config.get_value("IPTABLES", "icmp_flood_prevention") == true %}
                                                        checked {% endif %}
                                                        aria-describedby="icmp_flood_prevention_help">
                                                    <label class="form-check-label" for="icmp_flood_prevention">
                                                        ICMP flood Prevention
                                                    </label>
                                                    <small id="icmp_flood_prevention_help" class="form-text text-muted">
                                                        If you activate this setting, the ICMP protocol is
                                                        specially monitored
                                                        and
                                                        incoming connections are limited.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <input type="hidden" value="off"
                                                        name="checkbox_icmp_flood_prevention_log">
                                                    <input type="checkbox" id="icmp_flood_prevention_log"
                                                        name="icmp_flood_prevention_log"
                                                        {% if vars.config.get_value("IPTABLES", "icmp_flood_prevention_log") == true %}
                                                        checked {% endif %}
                                                        aria-describedby="icmp_flood_prevention_log_help">
                                                    <label class="form-check-label" for="icmp_flood_prevention_log">
                                                        Log all blocked connections from ICMP flood prevention
                                                    </label>
                                                    <small id="icmp_flood_prevention_log_help"
                                                        class="form-text text-muted">
                                                        If you check this box, ICMP flood prevention will record the
                                                        blocked connections in syslog. Please make sure that the syslog
                                                        is rotated regularly to avoid large logfiles.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <label for="icmp_flood_prevention_connection_limit">
                                                        Number of connections to the ICMP protocol until the
                                                        sender is blocked
                                                    </label>
                                                    <input type="text" class="form-control"
                                                        id="icmp_flood_prevention_connection_limit"
                                                        name="icmp_flood_prevention_connection_limit"
                                                        aria-describedby="icmp_flood_prevention_connection_limit_help"
                                                        placeholder="Example: 60"
                                                        {% if vars.config.get_value("IPTABLES", "icmp_flood_prevention_connection_limit") != "" %}
                                                        value={{vars.config.get_value("IPTABLES", "icmp_flood_prevention_connection_limit")}}
                                                        {% endif %}>
                                                    <small id="icmp_flood_prevention_connection_limit_help"
                                                        class="form-text text-muted">
                                                        Please enter the number of connections per minute on the
                                                        ICMP protocol
                                                        until the
                                                        sender address is blocked.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <label for="icmp_flood_prevention_log_limit">
                                                        Limit of entries in the log to blocked connections per
                                                        minute
                                                    </label>
                                                    <input type="text" class="form-control"
                                                        id="icmp_flood_prevention_log_limit"
                                                        name="icmp_flood_prevention_log_limit"
                                                        aria-describedby="icmp_flood_prevention_log_limit_help"
                                                        placeholder="Example: 5"
                                                        {% if vars.config.get_value("IPTABLES", "icmp_flood_prevention_log_limit") != "" %}
                                                        value={{vars.config.get_value("IPTABLES", "icmp_flood_prevention_log_limit")}}
                                                        {% endif %}>
                                                    <small id="icmp_flood_prevention_log_limit_help"
                                                        class="form-text text-muted">
                                                        Please enter the number of entries created by the ICMP flood
                                                        prevention to be stored per minute in the log file. The
                                                        configuration is needed to avoid log file flooding.
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-sm-6 mb-5">
                                        <div class="card border-secondary">
                                            <div class="card-header">
                                                Reject invalid packages
                                            </div>
                                            <div class="card-body">
                                                <div class="form-group">
                                                    <input type="hidden" value="off"
                                                        name="checkbox_drop_invalid_packets">
                                                    <input type="checkbox" id="drop_invalid_packets"
                                                        name="drop_invalid_packets"
                                                        {% if vars.config.get_value("IPTABLES", "drop_invalid_packets") == true %}
                                                        checked {% endif %}
                                                        aria-describedby="drop_invalid_packets_help">
                                                    <label class="form-check-label" for="drop_invalid_packets">
                                                        Reject invalid packages
                                                    </label>
                                                    <small id="drop_invalid_packets_help" class="form-text text-muted">
                                                        If you enable the setting, invalid packets are rejected
                                                        before they
                                                        reach the
                                                        application.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <input type="hidden" value="off"
                                                        name="checkbox_drop_invalid_packets_log">
                                                    <input type="checkbox" id="drop_invalid_packets_log"
                                                        name="drop_invalid_packets_log"
                                                        {% if vars.config.get_value("IPTABLES", "drop_invalid_packets_log") == true %}
                                                        checked {% endif %}
                                                        aria-describedby="drop_invalid_packets_log_help">
                                                    <label class="form-check-label" for="drop_invalid_packets_log">
                                                        Log all dropped invalid packages
                                                    </label>
                                                    <small id="drop_invalid_packets_log_help"
                                                        class="form-text text-muted">
                                                        If you check this box, dropped invalid packages will be recorded
                                                        in syslog. Please make sure that the syslog is rotated regularly
                                                        to avoid large logfiles.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <label for="drop_invalid_packets_log_limit">
                                                        Limit of entries in the log to dropped packages per
                                                        minute
                                                    </label>
                                                    <input type="text" class="form-control"
                                                        id="drop_invalid_packets_log_limit"
                                                        name="drop_invalid_packets_log_limit"
                                                        aria-describedby="drop_invalid_packets_log_limit_help"
                                                        placeholder="Example: 5"
                                                        {% if vars.config.get_value("IPTABLES", "drop_invalid_packets_log_limit") != "" %}
                                                        value={{vars.config.get_value("IPTABLES", "drop_invalid_packets_log_limit")}}
                                                        {% endif %}>
                                                    <small id="drop_invalid_packets_log_limit_help"
                                                        class="form-text text-muted">
                                                        Please enter the number of entries created by the dropped
                                                        packages to be stored per minute in the log file. The
                                                        configuration is needed to avoid log file flooding.
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6 mb-5">
                                        <div class="card border-secondary">
                                            <div class="card-header">
                                                port scan Prevention
                                            </div>
                                            <div class="card-body">
                                                <div class="form-group">
                                                    <input type="hidden" value="off"
                                                        name="checkbox_port_scan_prevention">
                                                    <input type="checkbox" id="port_scan_prevention"
                                                        name="port_scan_prevention"
                                                        {% if vars.config.get_value("IPTABLES", "port_scan_prevention") == true %}
                                                        checked {% endif %}
                                                        aria-describedby="port_scan_prevention_help">
                                                    <label class="form-check-label" for="port_scan_prevention">
                                                        port scan Prevention
                                                    </label>
                                                    <small id="port_scan_prevention_help" class="form-text text-muted">
                                                        If you activate this setting, incoming connections are checked
                                                        separately. If there are a large number of connections to
                                                        different ports from one sender in a short time, the sender is
                                                        blocked.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <input type="hidden" value="off"
                                                        name="checkbox_port_scan_prevention_log">
                                                    <input type="checkbox" id="port_scan_prevention_log"
                                                        name="port_scan_prevention_log"
                                                        {% if vars.config.get_value("IPTABLES", "port_scan_prevention_log") == true %}
                                                        checked {% endif %}
                                                        aria-describedby="port_scan_prevention_log_help">
                                                    <label class="form-check-label" for="port_scan_prevention_log">
                                                        Log all blocked connections from port scan
                                                        prevention
                                                    </label>
                                                    <small id="port_scan_prevention_log_help"
                                                        class="form-text text-muted">
                                                        If you check this box, SSH brute force prevention will record
                                                        the blocked connections in syslog. Please make sure that the
                                                        syslog is rotated regularly to avoid large logfiles.
                                                    </small>
                                                </div>

                                                <div class="form-group">
                                                    <label for="port_scan_prevention_log_limit">
                                                        Limit of entries in the log to blocked connections
                                                        per minute
                                                    </label>
                                                    <input type="text" class="form-control"
                                                        id="port_scan_prevention_log_limit"
                                                        name="port_scan_prevention_log_limit"
                                                        aria-describedby="port_scan_prevention_log_limit_help"
                                                        placeholder="Example: 5"
                                                        {% if vars.config.get_value("IPTABLES", "port_scan_prevention_log_limit") != "" %}
                                                        value={{vars.config.get_value("IPTABLES", "port_scan_prevention_log_limit")}}
                                                        {% endif %}>
                                                    <small id="port_scan_prevention_log_limit_help"
                                                        class="form-text text-muted">
                                                        Please enter the number of entries created by the port scan
                                                        prevention to be stored per minute in the log file. The
                                                        configuration is needed to avoid log file flooding.
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <button type="submit" class="btn btn-primary">Submit</button>
                            </form>
                        </div>

                        <div class="tab-pane {% if vars.active_tab == 'netinterfaces' %}active{% endif %}" id="netinterfaces" role="tabpanel">
                            
                            {{ info }}
                            
                            <form action="/options-save" method="post">

                                <input type="hidden" name="section" value="NETINTERFACES">
                                <input type="hidden" name="cfgtype" value="easywall">
                                <input type="hidden" name="active_tab" value="netinterfaces">

                                <div class="form-group">
                                    <label for="netinterface_lan">LAN</label>
                                    <select class="custom-select" id="netinterface_lan" name="lan">
                                        {% for x in vars.network_interfaces %}
                                            <option {% if vars.config.get_value("NETINTERFACES", "lan") == x[0] %}selected{% endif %} value="{{ x[0] }}">{{ x[0] }} ({{ x[1] }})</option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="netinterface_wan">WAN</label>
                                    <select class="custom-select" id="netinterface_wan" name="wan">
                                        {% for x in vars.network_interfaces %}
                                            <option {% if vars.config.get_value("NETINTERFACES", "wan") == x[0] %}selected{% endif %} value="{{ x[0] }}">{{ x[0] }} ({{ x[1] }})</option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="netinterface_vpn">VPN</label>
                                    <select class="custom-select" id="netinterface_vpn" name="vpn">
                                        {% for x in vars.network_interfaces %}
                                            <option {% if vars.config.get_value("NETINTERFACES", "vpn") == x[0] %}selected{% endif %} value="{{ x[0] }}">{{ x[0] }} ({{ x[1] }})</option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="netinterface_docker">Docker</label>
                                    <select class="custom-select" id="netinterface_docker" name="docker">
                                        {% for x in vars.network_interfaces %}
                                            <option {% if vars.config.get_value("NETINTERFACES", "docker") == x[0] %}selected{% endif %} value="{{ x[0] }}">{{ x[0] }} ({{ x[1] }})</option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <button type="submit" class="btn btn-primary">Submit</button>
                            </form>
                        </div>
                        
                        <div class="tab-pane {% if vars.active_tab == 'ipv6' %}active{% endif %}" id="ipv6"
                            role="tabpanel">
                            <form action="/options-save" method="post">

                                <input type="hidden" name="section" value="IPV6">
                                <input type="hidden" name="cfgtype" value="easywall">
                                <input type="hidden" name="active_tab" value="ipv6">

                                <div class="form-group">
                                    <input type="hidden" value="off" name="checkbox_enabled">
                                    <input type="checkbox" id="IPV6" name="enabled"
                                        {% if vars.config.get_value("IPV6", "enabled") == true %} checked {% endif %}
                                        aria-describedby="IPV6Help">
                                    <label class="form-check-label" for="IPV6">
                                        Enable IPv6
                                    </label>
                                    <small id="IPV6Help" class="form-text text-muted">Please only activate the function
                                        if <strong>IPv6</strong> is <strong>configured and activated</strong> on the
                                        server. If you disable the feature, easywall will disable IPv6 entirely on the
                                        server for security reasons.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <input type="hidden" value="off" name="checkbox_icmp_allow_router_advertisement">
                                    <input type="checkbox" id="icmp_allow_router_advertisement"
                                        name="icmp_allow_router_advertisement"
                                        {% if vars.config.get_value("IPV6", "icmp_allow_router_advertisement") == true %}
                                        checked {% endif %} aria-describedby="icmp_allow_router_advertisement_help">
                                    <label class="form-check-label" for="icmp_allow_router_advertisement">
                                        Allow ICMPv6 packets to find the router on the network
                                    </label>
                                    <small id="icmp_allow_router_advertisement_help" class="form-text text-muted">
                                        If you activate this setting, packets of ICMP type "133, 134 - Router
                                        Advertisement" are allowed incoming.<br />If you turn this setting off on an
                                        internal network, you may experience problems.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <input type="hidden" value="off" name="checkbox_icmp_allow_neighbor_advertisement">
                                    <input type="checkbox" id="icmp_allow_neighbor_advertisement"
                                        name="icmp_allow_neighbor_advertisement"
                                        {% if vars.config.get_value("IPV6", "icmp_allow_neighbor_advertisement") == true %}
                                        checked {% endif %} aria-describedby="icmp_allow_neighbor_advertisement_help">
                                    <label class="form-check-label" for="icmp_allow_neighbor_advertisement">
                                        Allow ICMPv6 packets to determine the IPv6 neighbours
                                    </label>
                                    <small id="icmp_allow_neighbor_advertisement_help" class="form-text text-muted">
                                        If you activate this setting, packets of ICMP type "135, 136 - Neighbor
                                        Advertisement" are allowed incoming.<br />If you turn this setting off on an
                                        internal network, you may experience problems.
                                    </small>
                                </div>

                                <button type="submit" class="btn btn-primary">Submit</button>
                            </form>
                        </div>

                        <div class="tab-pane {% if vars.active_tab == 'acceptance' %}active{% endif %}" id="acceptance"
                            role="tabpanel">
                            <form action="/options-save" method="post">

                                <input type="hidden" name="section" value="ACCEPTANCE">
                                <input type="hidden" name="cfgtype" value="easywall">
                                <input type="hidden" name="active_tab" value="acceptance">

                                <div class="form-group">
                                    <input type="hidden" value="off" name="checkbox_enabled">
                                    <input type="checkbox" id="enabled" name="enabled" aria-describedby="enabledHelp"
                                        {% if vars.config.get_value("ACCEPTANCE", "enabled") == true %} checked
                                        {% endif %}>
                                    <label class="form-check-label" for="enabled">Enable Acceptance</label>
                                    <small id="enabledHelp" class="form-text text-muted">
                                        Enable this feature to activate a timer which automatically resets the firewall
                                        to the last state when the firewall state is not accepted. This is highly
                                        recommended and enabled by default!
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label for="duration">Acceptance Duration</label>
                                    <input type="text" class="form-control" id="duration" name="duration"
                                        aria-describedby="durationHelp" placeholder="Example: 120"
                                        {% if vars.config.get_value("ACCEPTANCE", "duration") != "" %}
                                        value={{vars.config.get_value("ACCEPTANCE", "duration")}} {% endif %}>
                                    <small id="durationHelp" class="form-text text-muted">
                                        This option sets the duration until the firewall rules are restored from a
                                        backup. The default value is 120 and we recommend a number higher than this.
                                    </small>
                                </div>

                                <button type="submit" class="btn btn-primary">Submit</button>
                            </form>
                        </div>

                        <div class="tab-pane {% if vars.active_tab == 'logging' %}active{% endif %}" id="logging"
                            role="tabpanel">
                            <form action="/options-save" method="post">

                                <input type="hidden" name="section" value="LOG">
                                <input type="hidden" name="cfgtype" value="log">
                                <input type="hidden" name="active_tab" value="logging">

                                <div class="form-group">
                                    <label for="loglevel">Log Level</label>

                                    <select class="custom-select" id="loglevel" name="level">
                                        <option
                                            {% if vars.config_log.get_value("LOG", "level").lower() == "debug" %}selected{% endif %}>
                                            debug</option>
                                        <option
                                            {% if vars.config_log.get_value("LOG", "level").lower() == "info" %}selected{% endif %}>
                                            info</option>
                                        <option
                                            {% if vars.config_log.get_value("LOG", "level").lower() == "warning" %}selected{% endif %}>
                                            warning</option>
                                        <option
                                            {% if vars.config_log.get_value("LOG", "level").lower() == "error" %}selected{% endif %}>
                                            error</option>
                                        <option
                                            {% if vars.config_log.get_value("LOG", "level").lower() == "critical" %}selected{% endif %}>
                                            critical</option>
                                    </select>
                                    <small id="loglevelHelp" class="form-text text-muted">
                                        Please specify the log directory. We recommend using the local
                                        <code>../log/</code> directory. The use of the global <code>/log</code>
                                        directory is also possible.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label class="form-check-label" for="to_files">
                                        <input type="hidden" value="off" name="checkbox_to_files">
                                        <input type="checkbox" id="to_files" name="to_files"
                                            {% if vars.config_log.get_value("LOG", "to_files") == true %} checked
                                            {% endif %} aria-describedby="to_files_help">
                                        Write log to Logfile
                                    </label>
                                    <small id="to_files_help" class="form-text text-muted">
                                        If activated the config parameters filepath and filename will be read and the
                                        log will be written to the logfile.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label class="form-check-label" for="to_stdout">
                                        <input type="hidden" value="off" name="checkbox_to_stdout">
                                        <input type="checkbox" id="to_stdout" name="to_stdout"
                                            {% if vars.config_log.get_value("LOG", "to_stdout") == true %} checked
                                            {% endif %} aria-describedby="to_stdout_help">
                                        Write log to Stdout
                                    </label>
                                    <small id="to_stdout_help" class="form-text text-muted">
                                        When this is activated the log will be written to stdout. This is recommended!
                                        When the log is written to stdout it is mostly written to syslog.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label for="log_filepath">Log filepath</label>
                                    <input type="text" class="form-control" id="log_filepath" name="filepath"
                                        aria-describedby="log_filepath_help" placeholder="Example: /var/log/easywall"
                                        {% if vars.config_log.get_value("LOG", "filepath") != "" %}
                                        value={{vars.config_log.get_value("LOG", "filepath")}} {% endif %}>
                                    <small id="log_filepath_help" class="form-text text-muted">
                                        Please specify the log directory. You can use a relative or absolute path to the
                                        directory. Logfiles on Linux are normally stored in <code>/var/log</code>
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label for="log_filename">Log filename</label>
                                    <input type="text" class="form-control" id="log_filename" name="filename"
                                        aria-describedby="log_filename_help" placeholder="Example: easywall.log"
                                        {% if vars.config_log.get_value("LOG", "filename") != "" %}
                                        value={{vars.config_log.get_value("LOG", "filename")}} {% endif %}>
                                    <small id="log_filename_help" class="form-text text-muted">
                                        This option sets the logfile name. The logfile should have a normal file
                                        extension like <code>.log</code> or <code>.txt</code>
                                    </small>
                                </div>

                                <button type="submit" class="btn btn-primary">Submit</button>
                            </form>
                        </div>

                        <div class="tab-pane {% if vars.active_tab == 'binaries' %}active{% endif %}" id="binaries"
                            role="tabpanel">
                            <form action="/options-save" method="post">

                                <input type="hidden" name="section" value="EXEC">
                                <input type="hidden" name="cfgtype" value="easywall">
                                <input type="hidden" name="active_tab" value="binaries">

                                <div class="form-group">
                                    <label for="iptablesbin">File path to executable file for iptables</label>
                                    <input type="text" class="form-control" id="iptablesbin" name="iptables"
                                        aria-describedby="iptablesbinHelp" placeholder="Example: /sbin/iptables"
                                        {% if vars.config.get_value("EXEC", "iptables") != "" %}
                                        value={{vars.config.get_value("EXEC", "iptables")}} {% endif %}>
                                    <small id="iptablesbinHelp" class="form-text text-muted">
                                        Please provide the full path to the iptables executable binary.<br />
                                        You can read the path from the command line using the following command:
                                        <code>whereis iptables</code>.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label for="iptablessavebin">File path to executable file for iptables-save</label>
                                    <input type="text" class="form-control" id="iptablessavebin" name="iptables-save"
                                        aria-describedby="iptablessavebinHelp"
                                        placeholder="Example: /sbin/iptables-save"
                                        {% if vars.config.get_value("EXEC", "iptables-save") != "" %}
                                        value={{vars.config.get_value("EXEC", "iptables-save")}} {% endif %}>
                                    <small id="iptablessavebinHelp" class="form-text text-muted">
                                        Please provide the full path to the iptables-save executable binary.<br />
                                        You can read the path from the command line using the following command:
                                        <code>whereis iptables-save</code>.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label for="iptablesrestorebin">File path to executable file for
                                        iptables-restore</label>
                                    <input type="text" class="form-control" id="iptablesrestorebin"
                                        name="iptables-restore" aria-describedby="iptablesrestorebinHelp"
                                        placeholder="Example: /sbin/iptables-restore"
                                        {% if vars.config.get_value("EXEC", "iptables-restore") != "" %}
                                        value={{vars.config.get_value("EXEC", "iptables-restore")}} {% endif %}>
                                    <small id="iptablesrestorebinHelp" class="form-text text-muted">
                                        Please provide the full path to the iptables-restore executable binary.<br />
                                        You can read the path from the command line using the following command:
                                        <code>whereis iptables-restore</code>.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label for="ip6tablesbin">File path to executable file for ip6tables</label>
                                    <input type="text" class="form-control" id="ip6tablesbin" name="ip6tables"
                                        aria-describedby="ip6tablesbinHelp" placeholder="Example: /sbin/ip6tables"
                                        {% if vars.config.get_value("EXEC", "ip6tables") != "" %}
                                        value={{vars.config.get_value("EXEC", "ip6tables")}} {% endif %}>
                                    <small id="ip6tablesbinHelp" class="form-text text-muted">
                                        Please provide the full path to the ip6tables executable binary.<br />
                                        You can read the path from the command line using the following command:
                                        <code>whereis ip6tables</code>.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label for="ip6tablessavebin">File path to executable file for
                                        ip6tables-save</label>
                                    <input type="text" class="form-control" id="ip6tablessavebin" name="ip6tables-save"
                                        aria-describedby="ip6tablessavebinHelp"
                                        placeholder="Example: /sbin/ip6tables-save"
                                        {% if vars.config.get_value("EXEC", "ip6tables-save") != "" %}
                                        value={{vars.config.get_value("EXEC", "ip6tables-save")}} {% endif %}>
                                    <small id="ip6tablessavebinHelp" class="form-text text-muted">
                                        Please provide the full path to the ip6tables-save executable binary.<br />
                                        You can read the path from the command line using the following command:
                                        <code>whereis ip6tables-save</code>.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label for="ip6tablesrestorebin">File path to executable file for
                                        ip6tables-restore</label>
                                    <input type="text" class="form-control" id="ip6tablesrestorebin"
                                        name="ip6tables-restore" aria-describedby="ip6tablesrestorebinHelp"
                                        placeholder="Example: /sbin/ip6tables-restore"
                                        {% if vars.config.get_value("EXEC", "ip6tables-restore") != "" %}
                                        value={{vars.config.get_value("EXEC", "ip6tables-restore")}} {% endif %}>
                                    <small id="ip6tablesrestorebinHelp" class="form-text text-muted">
                                        Please provide the full path to the ip6tables-restore executable binary.<br />
                                        You can read the path from the command line using the following command:
                                        <code>whereis ip6tables-restore</code>.
                                    </small>
                                </div>

                                <button type="submit" class="btn btn-primary">Submit</button>
                            </form>
                        </div>

                        <div class="tab-pane {% if vars.active_tab == 'webinterface' %}active{% endif %}"
                            id="webinterface" role="tabpanel">
                            <form action="/options-save" method="post">

                                <input type="hidden" name="section" value="uwsgi">
                                <input type="hidden" name="cfgtype" value="web">
                                <input type="hidden" name="active_tab" value="webinterface">

                                <div class="form-group">
                                    <label for="index-page">Dashboard page</label>
                                    <input type="text" class="form-control" id="index-page" name="index-page"
                                        placeholder="index.html"
                                        {% if vars.config_web.get_value("uwsgi", "index-page") != "" %}
                                        value={{vars.config_web.get_value("uwsgi", "index-page")}} {% endif %}>
                                </div>

                                <div class="form-group">
                                    <label for="https-socket">Options to start the web server</label>
                                    <input type="text" class="form-control" id="https-socket" name="https-socket"
                                        aria-describedby="https-socket_help"
                                        placeholder="0.0.0.0:12227,ssl/easywall.crt,ssl/easywall.key,HIGH"
                                        {% if vars.config_web.get_value("uwsgi", "https-socket") != "" %}
                                        value={{vars.config_web.get_value("uwsgi", "https-socket")}} {% endif %}>
                                    <small id="https-socket_help" class="form-text text-muted">
                                        Please enter here the HTTPS information to start the UWSGI web server.<br />
                                        The string is built from IP address, port, path to the SSL certificate,
                                        path to the SSL key, and the SSL cipher strength.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label for="login_attempts">Login attempts</label>
                                    <input type="text" class="form-control" id="login_attempts" name="login_attempts"
                                        aria-describedby="login_attempts_help" placeholder="10"
                                        {% if vars.config_web.get_value("WEB", "login_attempts") != "" %}
                                        value={{vars.config_web.get_value("WEB", "login_attempts")}} {% endif %}>
                                    <small id="login_attempts_help" class="form-text text-muted">
                                        Please enter the number of login attempts until the sender IP address is blocked
                                        for the time configured below.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label for="login_bantime">Login bantime in seconds</label>
                                    <input type="text" class="form-control" id="login_bantime" name="login_bantime"
                                        aria-describedby="login_bantime_help" placeholder="10"
                                        {% if vars.config_web.get_value("WEB", "login_bantime") != "" %}
                                        value={{vars.config_web.get_value("WEB", "login_bantime")}} {% endif %}>
                                    <small id="login_bantime_help" class="form-text text-muted">
                                        Time in seconds that the sender is blocked if there are too many failed logins.
                                    </small>
                                </div>

                                <b>Navigation</b><br>

                                <div class="form-group m-1">
                                    <input type="hidden" value="off" name="checkbox_nav_blacklist">
                                    <input type="checkbox" id="nav_blacklist" name="nav_blacklist"
                                        {% if vars.config_web.get_value("uwsgi", "nav_blacklist") == true %} checked {% endif %}>
                                    <label class="form-check-label" for="nav_blacklist">Blacklist</label>
                                </div>

                                <div class="form-group m-1">
                                    <input type="hidden" value="off" name="checkbox_nav_whitelist">
                                    <input type="checkbox" id="nav_whitelist" name="nav_whitelist"
                                        {% if vars.config_web.get_value("uwsgi", "nav_whitelist") == true %} checked {% endif %}>
                                    <label class="form-check-label" for="nav_whitelist">Whitelist</label>
                                </div>

                                <div class="form-group m-1 mb-3">
                                    <input type="hidden" value="off" name="checkbox_nav_custom">
                                    <input type="checkbox" id="nav_custom" name="nav_custom"
                                        {% if vars.config_web.get_value("uwsgi", "nav_custom") == true %} checked {% endif %}>
                                    <label class="form-check-label" for="nav_custom">Custom</label>
                                </div>
                                
                                <button type="submit" class="btn btn-primary">Submit</button>
                            </form>
                        </div>

                        <div class="tab-pane {% if vars.active_tab == 'user' %}active{% endif %}" id="user"
                            role="tabpanel">
                            <form action="/options-save" method="post">

                                <input type="hidden" name="section" value="WEB">
                                <input type="hidden" name="cfgtype" value="web">
                                <input type="hidden" name="active_tab" value="user">

                                <div class="form-group">
                                    <label for="username">Username for the web interface</label>
                                    <input type="text" class="form-control" id="username" name="username"
                                        aria-describedby="username_help" placeholder="enter username here"
                                        {% if vars.config_web.get_value("WEB", "username") != "" %}
                                        value={{vars.config_web.get_value("WEB", "username")}} {% endif %}>
                                    <small id="username_help" class="form-text text-muted">
                                        Please enter the username for the web interface.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label for="password1">Password for the web interface</label>
                                    <input type="password" AUTOCOMPLETE="off" class="form-control" id="password1"
                                        name="password1" aria-describedby="password1_help">
                                    <small id="password1_help" class="form-text text-muted">
                                        Please enter the password for the web interface.<br />
                                        If you leave the value blank, the password will not be overwritten.
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label for="password2">Password confirmation</label>
                                    <input type="password" AUTOCOMPLETE="off" class="form-control" id="password2"
                                        name="password2" aria-describedby="password2_help">
                                    <small id="password2_help" class="form-text text-muted">
                                        Please confirm the password entered above.
                                    </small>
                                </div>

                                <button type="submit" class="btn btn-primary">Submit</button>
                            </form>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% include 'footer.html' %}